import{a as h}from"./axios-Bo0ATomq.js";import{_ as E,c as u,b as a,a as e,g as v,F as V,f as x,t as d,w as I,r as _,o as p,e as S,v as k,h as f,i as w}from"./index-BtMwWJyb.js";var L={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"yu-t-200053",BASE_URL:"/HexSchool-2023Vue/w6/dist/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:g,VITE_PATH:b}=L,U={data(){return{carts:{},form:{user:{name:"",email:"",tel:"",address:""},message:""},isLoading:!1,loadingStatus:{loadingItem:""}}},methods:{getCart(){this.isLoading=!0;const n=`${g}/api/${b}/cart`;h.get(n).then(t=>{this.carts=t.data.data,this.isLoading=!1})},Submit(){console.log(this.form)},deleteCart(n){const t=`${g}/api/${b}/cart/${n}`;this.loadingStatus.loadingItem=n,h.delete(t).then(i=>{alert(i.data.message),this.getCart(),this.loadingStatus.loadingItem=""}).catch(i=>{alert(i.response.data.message)})},deleteAll(){const n=`${g}/api/${b}/carts`;this.loadingStatus.loadingItem=!0,h.delete(n).then(t=>{alert(t.data.message),this.getCart(),this.loadingStatus.loadingItem=""}).catch(t=>{alert(t.response.data.message)})}},mounted(){this.getCart()}},F={class:"container"},T=e("h2",{class:"text-center"},"前台購物車",-1),q={class:"text-end my-3"},A=["disabled"],M={class:"table align-middle"},D=e("thead",null,[e("tr",null,[e("td",{width:"10%"}),e("td",{width:"40%"},"品名"),e("td",{width:"30%"},"數量 / 單位"),e("td",{width:"30%"},"單價")])],-1),R=["onClick","disabled"],B={class:"input-group"},H=["onUpdate:modelValue","disabled"],P=["value"],N={class:"input-group-text",for:"cart"},O={class:"text-end"},z={class:"text-end"},j=e("td",{colspan:"3"},"總計",-1),G=e("td",{colspan:"3",class:"text-success"},"折扣價",-1),J={class:"text-success"},K={class:"row"},Q={class:"mb-3"},W=e("label",{for:"email",class:"form-label"},"Email",-1),X={class:"mb-3"},Y=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),Z={class:"mb-3"},$=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),ee={class:"mb-3"},te=e("label",{for:"address",class:"form-label"},"收件人地址",-1),se={class:"mb-3"},le=e("label",{for:"message",class:"form-label"},"留言",-1),oe=e("div",{class:"text-end"},[e("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1);function ae(n,t,i,ne,s,r){const y=_("FullLoading"),c=_("VeeField"),m=_("ErrorMessage"),C=_("VeeForm");return p(),u("div",F,[a(y,{active:s.isLoading},null,8,["active"]),T,e("div",q,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:t[0]||(t[0]=v((...l)=>r.deleteAll&&r.deleteAll(...l),["prevent"])),disabled:s.loadingStatus.loadingItem===!0}," 清空購物車 ",8,A)]),e("table",M,[D,e("tbody",null,[(p(!0),u(V,null,x(s.carts.carts,l=>(p(),u("tr",{key:l.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:v(o=>r.deleteCart(l.id),["prevent"]),disabled:s.loadingStatus.loadingItem===l.id}," × ",8,R)]),e("td",null,d(l.product.title),1),e("td",null,[e("div",B,[S(e("select",{class:"form-select",id:"cart","onUpdate:modelValue":o=>l.qty=o,disabled:s.loadingStatus.loadingItem===l.id},[(p(),u(V,null,x(20,o=>e("option",{key:o,value:o},d(o),9,P)),64))],8,H),[[k,l.qty]]),e("label",N,d(l.product.unit),1)])]),e("td",O,"$ "+d(l.product.price),1)]))),128))]),e("tfoot",z,[e("tr",null,[j,e("td",null,"$ "+d(s.carts.total),1)]),e("tr",null,[G,e("td",J,"$ "+d(s.carts.final_total),1)])])]),e("div",K,[a(C,{onSubmit:r.Submit,ref:"form",class:"col-md-6"},{default:I(({errors:l})=>[e("div",Q,[W,a(c,{id:"email",name:"email",type:"email",class:f(["form-control",{"is-invalid":l.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:s.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=o=>s.form.user.email=o)},null,8,["class","modelValue"]),a(m,{name:"email",class:"invalid-feedback"})]),e("div",X,[Y,a(c,{id:"name",name:"姓名",type:"text",class:f(["form-control",{"is-invalid":l.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:s.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=o=>s.form.user.name=o)},null,8,["class","modelValue"]),a(m,{name:"姓名",class:"invalid-feedback"})]),e("div",Z,[$,a(c,{id:"tel",name:"電話",type:"tel",class:f(["form-control",{"is-invalid":l.電話}]),placeholder:"請輸入電話",rules:"required|min:8",modelValue:s.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=o=>s.form.user.tel=o)},null,8,["class","modelValue"]),a(m,{name:"電話",class:"invalid-feedback"})]),e("div",ee,[te,a(c,{id:"address",name:"地址",type:"text",class:f(["form-control",{"is-invalid":l.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:s.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=o=>s.form.user.address=o)},null,8,["class","modelValue"]),a(m,{name:"地址",class:"invalid-feedback"})]),e("div",se,[le,S(e("textarea",{id:"message",name:"留言",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=o=>s.form.message=o)},null,512),[[w,s.form.message]])]),oe]),_:1},8,["onSubmit"])])])}const re=E(U,[["render",ae]]);export{re as default};
